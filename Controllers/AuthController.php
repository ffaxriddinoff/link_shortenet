<?phpnamespace Controllers;use Models\Link;use Models\User;class AuthController extends Controller{    private User $user;    private Link $link;    public function __construct()    {        parent::__construct();        $this->user = new User($this->db);        $this->link = new Link($this->db);    }    public function index()    {        if ($this->isLoggedIn()) {            $links = $this->link->getAllLinksByUserId($_SESSION['user_id']);            require __DIR__ . '/../Views/link/list.php';        } else {            header('Location: /login');            exit;        }    }    public function login()    {        if ($_SERVER['REQUEST_METHOD'] === 'POST') {            $username = $_POST['username'];            $password = $_POST['password'];            $user = $this->user->findByUsername($username);            if ($user && password_verify($password, $user['password'])) {                session_start();                $_SESSION['user_id'] = $user['id'];                $_SESSION['username'] = $user['username'];                echo "Login successful";            } else {                echo "Invalid username or password";            }        } else {            require __DIR__ . '/../Views/auth/login.php';        }    }    public function register()    {        if ($_SERVER['REQUEST_METHOD'] === 'POST') {            $username = $_POST['username'];            $password = $_POST['password'];            $this->user->create($username, $password);            $user = $this->user->findByUsername($username);            session_start();            $_SESSION['user_id'] = $user['id'];            $_SESSION['username'] = $user['username'];            require __DIR__ . '/../Views/link/list.php';        } else {            require __DIR__ . '/../Views/auth/register.php';        }    }    public function logout()    {        session_start();        session_unset();        session_destroy();        header('Location: /login');        exit;    }    private function isLoggedIn()    {        session_start();        return isset($_SESSION['user_id']);    }}